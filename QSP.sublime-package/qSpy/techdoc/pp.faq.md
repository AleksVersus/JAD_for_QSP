# Небольшой FAQ по препроцессору

## Разный набор функций для разных проектов
В:

Это первый вопрос, который возник у меня, как у автора препроцессора. У меня есть модуль-библиотека "easy.math.qsp" со множеством функций. Во всех проектах этот модуль подключается подобным образом:

```json
{
	"project":
	[
		{...},
		{
			"module":"..\\example_game\\lib\\easy.math.qsp",
			"folders":
			[
				{
					"path":"[lib]\\easy.math.3"
				}
			]
		},
		{...}
	],
	"start":"..\\example_game\\game.qsp",
	"player":"qspgui.exe",
	"preprocessor":"On"
}
```

Однако не во всех проектах используется весь набор функций из этого модуля. Хочу, чтобы для каждого отдельного проекта подтягивался свой собственный набор функций, а так же, чтобы я мог собирать библиотеку, как отдельный проект, со всеми возможными функциями.

Что я сделал в первую очередь. Для каждой локации, которая в библиотеке является функцией, я завёл условие типа такого:

```qsp
!@pp:if(em_maxVar):include
# em.maxVar
! это функция в библиотеке easy.math
	$result="код функции"
--
!@pp:endif
```

Теперь, в самом первом файле любого проекта мне достаточно определить метку этой функции, и функция будет добавлена в конечный файл библиотеки "easy.math.qsp", собираемый вместе со сторонним проектом.

```qsp
# start
! это самая первая локация в собираемом проекте,
! файл с этой локацией лежит в корне проекта игры, поэтому здесь
! удобнее всего назначать метки
!@pp:var(em_maxVar)
inclib 'easy.math.qsp'
--
```

Однако, поскольку все метки глобальны для всего проекта, я не могу проделать то же самое с самой первой локацией библиотеки "easy.math.qsp", чтобы когда я собираю библиотеку, как отдельный проект, все функции были подключены, ведь самая первая локация библиотеки "easy.math.qsp" находится в файле, который так же обрабатывается препроцессором из сторонних проектов. Как добиться того, чтобы метки в этом файле определялись только если я собираю "easy.math.qsp", как отдельный проект?

О:

На самом деле всё очень просто. Для библиотекчки `easy.math` я завёл отдельный файл, в котором прописал объявление всех меток для всех функций библиотечки. Этому файлу я назначил расширение "`.qsps_`", таким образом он не подхватывается автоматически при сборке библиотечки сторонними проектами, однако он подключается принудительно в `qsp-project.json` самой библиотечки:

```json
{
    "project": [
        {
            "files": [
                {
                    "path": ".\\00_sets\\_variables.qsps_"
                }
            ],
            "folders": [
                {
                    "path": "."
                }
            ],
            "module": "..\\..\\[releases]\\easy.math\\easy.math.qsp"
        }
    ],
    "player": "..\\..\\..\\..\\QSP 590 QG 410b\\qspgui.exe",
    "start": "..\\..\\[releases]\\easy.math\\easy.math.qsp",
    "preprocessor": "On"
}
```

Таким образом этот файл ставится в списке на разбор препроцессором самым первым, а значит при препроцессинге библиотечки все метки из этого файла будут объявлены, и все функции добавятся к конечному модулю.